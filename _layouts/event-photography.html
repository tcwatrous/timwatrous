{% include header.html %}

    <main id="portfolio">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1 class="portfolio-header">event photography</h1>
      </div>
    </div>

    <!-- ðŸ“¸ Portfolio Grid Start -->
    <div class="portfolio-grid">
      {% for item in site.data.portfolio %}
        <img
          class="img-portfolio"
          src="{{ item.src | replace: '.jpg', '-blur.jpg' }}"
          data-src="{{ item.src }}"
          alt="{{ item.alt | default: '' }}"
          height="{{ item.height }}"
          width="{{ item.width }}"
          style="height: auto;"
          loading="eager"
          draggable="false"
        />
      {% endfor %}
    </div>
    <!-- ðŸ“¸ Portfolio Grid End -->

    <!-- Lightbox container (hidden by default) -->
 <div id="lightbox">
  <button id="lightbox-prev" class="lightbox-nav">&lt;</button>
  <img id="lightbox-img" src="" alt="" />
  <button id="lightbox-next" class="lightbox-nav">&gt;</button>
</div>
  </div>
</main>



<!-- ðŸ–¼ Lazy Load Script -->
<script>
  document.addEventListener('DOMContentLoaded', function () {


    // loading images
    const imagesLoading = document.querySelectorAll('img[data-src]');

    if ('IntersectionObserver' in window) {
      const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            const fullSrc = img.getAttribute('data-src');
            if (fullSrc) {
              const fullImg = new Image();
              fullImg.src = fullSrc;
              fullImg.onload = () => {
                img.src = fullSrc;
                img.removeAttribute('data-src');
                img.classList.add('loaded');
              };
            }
            obs.unobserve(img);
          }
        });
      }, {
        rootMargin: '300px',
        threshold: 0.01
      });

      imagesLoading.forEach(img => observer.observe(img));
    } else {
      // Fallback: load all full images immediately
      imagesLoading.forEach(img => {
        const fullSrc = img.getAttribute('data-src');
        if (fullSrc) {
          img.src = fullSrc;
          img.removeAttribute('data-src');
        }
      });
    }
    




    // lightbox functionality

    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightbox-img');
    const prevBtn = document.getElementById('lightbox-prev');
    const nextBtn = document.getElementById('lightbox-next');

    // Gather all images in the portfolio into an array
    const images = Array.from(document.querySelectorAll('.img-portfolio'));
    let currentIndex = -1;

    function showLightbox(index) {
      if (index < 0) index = images.length - 1;
      if (index >= images.length) index = 0;
      currentIndex = index;
      const img = images[index];
      lightboxImg.src = img.dataset.src || img.src;
      lightbox.classList.add('visible');
    }

    // Open lightbox on image click (only if viewport >= 600)
    images.forEach((img, index) => {
      img.style.cursor = 'pointer';
      img.addEventListener('click', () => {
        if (window.innerWidth >= 600) {
          showLightbox(index);
        }
      });
    });

    

    // Close lightbox clicking outside or ESC key
    lightbox.addEventListener('click', e => {
      if (e.target === lightbox || e.target === lightboxImg) {
        closeLightbox();
      }
    });

    document.addEventListener('keydown', e => {
      if (e.key === 'Escape' && lightbox.classList.contains('visible')) {
        closeLightbox();
      }
      if (lightbox.classList.contains('visible')) {
        if (e.key === 'ArrowRight') {
          showLightbox(currentIndex + 1);
        }
        if (e.key === 'ArrowLeft') {
          showLightbox(currentIndex - 1);
        }
      }
    });

    prevBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      showLightbox(currentIndex - 1);
    });

    nextBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      showLightbox(currentIndex + 1);
    });

    function closeLightbox() {
      lightbox.classList.remove('visible');
      setTimeout(() => {
        lightboxImg.src = '';
      }, 300);
    }



    //end
  });
</script>

{% include footer.html %}
